const input = `.....#.......................#................#............#........#..........................................#.......#....................\n.........................................................................#.................#........................................#.......\n............#...........................#..........................................................................#........................\n..#..................................................#......................................................................................\n......................#............#...........................................#..................#.........................#............#..\n................................................#...........................................................................................\n..............................#............................#...........................................................#....................\n......................................#...............................#.....................................................................\n........................#......................................................................................#...........................#\n............#.............................................................#..................#...........#......................#...........\n#...........................................................................................................................................\n.....#..............#......#........................#..........#...........................................................#................\n.................................#...................................#.................#..............................#.....................\n..........#................................#................................................................................................\n.........................................................................#..................#...............................................\n...#.....................................................................................................#............................#.....\n...............#............#....................#.................................................#........................................\n.......#..............#....................................#..........#........................................#.............#..............\n......................................................................................................................#...........#.........\n...............................#...........................................#................................................................\n...................#..................................................................................#.....................................\n....................................................#.........#..................................................#..........................\n............................................#....................................#...............#........................................#.\n........................................................................................#...................................................\n...........#.........#..............#.............................................................................................#.........\n...........................#................................................................................#...............................\n.....#........................................................................#..............#.........................#....................\n...............................................#.............#.........................................................................#....\n.....................................................#.............................................#..........................#.............\n..#.................#................................................#............#.....#......................#............................\n...............#.......................#....................................#..................#............................................\n..................................................#.........................................................................................\n.............................#..........................#........#..........................................#...............#............#..\n..........#..............................................................#..........................................................#.......\n.....................................................................................................................#......................\n...#.................................................#...................................#..................................................\n..............#.................#.....#................................................................................................#....\n....................#........................#.......................................................#......................................\n...........................................................#.......#..............#............................#............................\n...........#................................................................................#...............................................\n...........................#...........................................................................................#....................\n.....#....................................#...........................#.....#...............................................................\n....................................................#.................................#.....................................................\n................................................................................................#.....................................#.....\n......................................#..........................................#.............................................#............\n........................#......#.......................#...................................#...............#..........#.....................\n..................#............................................#...................................#........................................\n...............................................................................................................#..................#.........\n.......#...........................#.......#......#.................#......................................................................#\n..........................#.......................................................#.........................................................\n...#......................................................................#...................#.............................................\n........................................#..................#..............................................#.............#...................\n.......................................................................................#.........................#...............#..........\n............................................................................................................................................\n.............#......#..........#................#...........................................#...............................................\n..................................................................#...............................#.........................................\n............................................................................................................................................\n................#..........#.......#...............................................#............................#........................#..\n#.........#...............................................................................#.................................................\n........................................#.................................................................................#.................\n.....#.............#................................#...................#..............................#...........#........................\n.........................#..................................#...............................................................................\n...............................................................................#................................................#......#....\n.....................................................................................#......................................................\n...........#......................#....................#.....................................#.............................................#\n#.................#...............................................#......................................................#.........#........\n.............................................#...............#..............#...............................................................\n........................................#..........................................................#.............#......................#...\n.........#.....................#..........................................................#.................................................\n..................................................#..................................#...............................#......................\n....................................#...................#...................................................................................\n.............#................................................................#.............................................................\n......................#..............................................#........................................#..........#..................\n.............................................................#...........................................................................#..\n#.........................................#........................................#...............#.....#....................#.............\n.....#.............................#.............#.......................#.................#.......................#...............#........\n.................................................................#.............#............................................................\n...............#............................................................................................................................\n........................................#............................#......................................................................\n...........................................................#..........................#...........#..............................#..........\n.#....................#.............................................................................................#.......................\n............................................................................................................................................\n..............................................#............................................#..............................................#.\n...........#................................................................................................#................#..............\n............................................................#.........#................#..............................#.....................\n..#....................................................................................................................................#....\n..................................#............................................................#.....#......................................\n............................#..............................................................................................#.......#........\n......#..........#..........................................................................................................................\n...............................................................#................................................#...........................\n........................................#.............#..............................#........................................#............#\n..........................#..........................................#......#........................................#......................\n#...........#.................................#.............................................................................................\n............................................................................................................................................\n..............................................................................................#..........#.............................#....\n.....................#.................................................................#....................................................\n...#....................................................................#.......................................#............#..............\n..........................#..........#.......................#.....................................................................#........\n...........................................#......................#.........#............................................................#..\n#.................#....................................#...........................#..............#.........................................\n................................................#........................................................................#..................\n....#.............................#...................................#.....................................................................\n.............#..............................................#.................................................................#........#....\n..........................#......................................................#.......................#......#...........................\n........................................#.............#................................#....................................................\n.#......#.........................................................................................#...............................#........#\n....................................#............#..........................................................................................\n...............#.............#.........................................................................................#....................\n............................................................................................................................................\n.........................#.................................#....................................#.....#.....................................\n#...........................................................................#....................................#..................#.......\n.................#.....................#...................................................................................#................\n........#...................................#.................#...........................#..............#..................................\n......................................................#............#...............#...............#........................................\n.........................................................................#..................................................................\n.................................#.....................................................#......#.............................................\n.........................................#.................................................................#.............#........#.........\n...............#......................................................#.....#.............................................................#.\n..........#....................................................#.....................................#......................................\n.....#................................#...............................................................................#.....................\n...........................#...............................#.................................#.........................................#....\n................................#.................................................................#.........................................\n..............#..........................#..................................................................#..............#................\n.........#.......................................#..................................................................#.............#.........\n......................................................................#.....................................................................\n......................#..........................................#.....................................#....................................\n#..............................................................................#.......#....................................................\n..................................#.........................................................................................................\n...........#..................................................#.........#..........................................#........................\n.......................................#.......#..........................................#........#........#.........................#.....\n....................#...............................................#.......................................................................\n................................#..........#...........................................................................#....................\n..#......#............................................................................................#.........#..................#........\n.........................#.......................................................................#..........................#...............\n...........................................................................#................................................................\n................#.....................................#......#.....................................................#........................\n....................................................................................................#....................................#..\n.................................................................#...............#.......#..................................................\n.........#..........................#...................................#...............................#...................................\n..............................#................#............................................................................#...............`;


function inputToSkyMap(input) {
  const data = input.split('\n');
  const rows = data.length;
  const cols = data[0].length;
  const matrix = Array.from({length: rows}, () => Array(cols));
  for (let row = 0; row < rows; row++) {
    for (let col = 0; col < cols; col++) {
      matrix[row][col] = data[row][col];
    }
  }
  return matrix;
}

function getIndOfEmptyRows(matrix) {
  const rowSet = new Set();
  for (const [i, row] of matrix.entries()) {
    if (row.some(cell => cell == '#')) continue;
    rowSet.add(i);
  }
  return rowSet;
}

function getIndOfEmptyCols(matrix) {
  const colSet = new Set();
  for (let col = 0; col < matrix[0].length; col++) {
    const colData = matrix.map(row => row[col]);
    if (colData.some(cell => cell == '#')) continue;
    colSet.add(col);
  }
  return colSet;
}

function getManhattanDist(cell1, cell2, rowSet, colSet, emptyCost = 1) {
  const colMin = Math.min(cell1.col, cell2.col);
  const colMax = Math.max(cell1.col, cell2.col);
  const rowMin = Math.min(cell1.row, cell2.row);
  const rowMax = Math.max(cell1.row, cell2.row);
  let counterEmptySpace = 0;
  for (let i = colMin; i <= colMax; i++) {
    if (colSet.has(i)) counterEmptySpace++;
  }
  for (let i = rowMin; i <= rowMax; i++) {
    if (rowSet.has(i)) counterEmptySpace++;
  }
  return (colMax - colMin) + (rowMax - rowMin) + counterEmptySpace * emptyCost;
}

function getGalaxiesPositions(matrix) {
  const positions = [];
  for (let row = 0; row < matrix.length; row++) {
    for (let col = 0; col < matrix.length; col++) {
      if (matrix[row][col] == '#') positions.push({row, col});
    }
  }
  return positions;
}

const matrix = inputToSkyMap(input);
const rowSet = getIndOfEmptyRows(matrix);
const colSet = getIndOfEmptyCols(matrix);
const positions = getGalaxiesPositions(matrix);
const allPairs = positions.flatMap((pos1, i) => positions.slice(i + 1).map(pos2 => [pos1, pos2]));

// part 1
let sum = 0;
for (const [p1, p2] of allPairs) {
  sum += getManhattanDist(p1, p2, rowSet, colSet);
}
console.log(sum);

// part 2
let sump2 = 0;
for (const [p1, p2] of allPairs) {
  sump2 += getManhattanDist(p1, p2, rowSet, colSet, 999999);
}
console.log(sump2);