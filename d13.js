const input = `\n######..#\n.##....#.\n.....##.#\n.....##.#\n.##..#.#.\n######..#\n#..#..###\n.##..#.##\n#####.#.#\n#..#.##..\n.....###.\n#####....\n....##.#.\n\n##..###.###..\n##.#.#..##..#\n..#.#...#.#.#\n######.#.####\n##..#.##....#\n##.##.#..#.#.\n#####....#.#.\n###.########.\n#######..#.##\n..####..##..#\n......#.###..\n......#.###..\n..####..#...#\n\n....#....##..##..\n##.#.....#....#..\n....##...#.##.#..\n..##..#####..####\n###..##..######..\n.....##.#.#..#.#.\n.#.#####.##..##.#\n###.###...####...\n....####.#....#.#\n\n#.##.#.####.#\n.#..#..#..#..\n.####.#....#.\n#....#......#\n.#..#.#....#.\n.##.#.######.\n#....########\n#....##....##\n########..###\n.#..#..####..\n.#..#..####..\n..##....##...\n.####...##...\n.#..#.##..##.\n##..#########\n\n#.##.#.##\n#....##..\n.......##\n#....##..\n#....####\n#.####.##\n.####.###\n\n.###.####\n.##.##..#\n.###.####\n#....#..#\n....#....\n##.##....\n##.###..#\n#..#..##.\n.#...#..#\n....#....\n##.######\n...###.##\n#.###....\n##.#.####\n##.#.####\n\n......##.##\n####..###..\n.##....#.#.\n######.####\n######.####\n.##....#.#.\n####..###..\n......##.##\n.##.##.##.#\n...##..###.\n....###.##.\n#..#......#\n....##.....\n#####.#.#..\n.....#..##.\n\n###.....###..##\n#.#..#..##...##\n..##.#...###.##\n..##.#...##..##\n#.#..#..##...##\n###.....###..##\n.##.#...#.#...#\n##...#####.###.\n##.#...###....#\n#.####..#.#.#..\n#.##..###.###..\n#.##..###.###..\n#.####..#.#.#..\n##.#...###....#\n##...#####.###.\n\n..###..#....#..\n##.....#.##.#..\n###....#.##.#..\n###.#..#....#..\n..##.#........#\n####...........\n..##...##..##..\n##...#.######.#\n..#.#.########.\n##....#.####.#.\n##.#.####...###\n##...#.#....#.#\n##...##.#..#.##\n\n##..#..#..##..#\n.###....###.#..\n.#...##...#..#.\n..##.##.##.....\n.#.#.##.#.#.#.#\n.....#........#\n.#..####..#.##.\n####.##.####.##\n####.##.####.##\n\n.#.#..####.\n#.####.##.#\n..#..######\n..#...####.\n..#...####.\n..#..######\n#.####.##.#\n.#.#..####.\n#..#.##..##\n#.#.#######\n###........\n....##....#\n..#.###..##\n...#..#.##.\n.#.#.##..##\n\n##...#...##.#.#.#\n##.#.......#.#.##\n##.#.......#.#.##\n##.......##.#.#.#\n###....#.##.#...#\n.#.#.#..#.###.##.\n.#...#..##.......\n#..#.#....#.##.##\n.#.##...###.#..##\n.##.#.#.#.#...###\n#...##..#...#.##.\n.#.####...#..#.##\n.#.####...#..#.##\n#...##..#...#.##.\n.##.#.#.#.#...###\n\n.....#.##..##.#\n.....#.##..##.#\n.##.##.##..##..\n....#..#....#..\n#..#.###....###\n##..#.##.##.##.\n#...##........#\n.#..#.###..###.\n..##...#....#..\n#....#.##..##.#\n#.##..###..###.\n\n.##.....#..#.\n.##..#.######\n#.#...#......\n.###..#......\n..#..#..#..#.\n..#..#..#..#.\n.###.##......\n#.#...#......\n.##..#.######\n.##.....#..#.\n........####.\n.####.##....#\n.#.##.#......\n######..####.\n.#.##..##..##\n....##.#....#\n.###.#.######\n\n###.#.####.#.\n###.#.####.#.\n...#.#.##.#.#\n###...#..#...\n.#.#.#....#.#\n##..#..#...#.\n..###..##..##\n####..#..#..#\n#...#......#.\n..##..####..#\n.#..########.\n.#.#.#....#.#\n#..####..####\n.#...........\n#.#.#.#..#.#.\n\n#.#....\n#.#....\n#..#..#\n..##..#\n#......\n#......\n..#.##.\n#.#.##.\n#.##...\n..#.##.\n#.#.##.\n#.#####\n#.#####\n.#.####\n##..##.\n\n.##.....###\n#..###.##.#\n.##..#.##..\n.....#.#.#.\n#..##.#..##\n#..##.#..##\n.....#.#.#.\n.##..#.##..\n#..###.##.#\n.##..#..###\n#..##..##.#\n####...##.#\n#..#.#.#.#.\n........#.#\n....####...\n....#.###.#\n.##.#.#..#.\n\n###.######.\n...##.##.##\n.###.#..#.#\n....######.\n.#.########\n#####....##\n..##..##..#\n#.##..##..#\n##....##...\n.#..#......\n#####....##\n##....##...\n.##.######.\n###..####..\n....#.##.#.\n....#.##.#.\n###..####..\n\n#.####..####.##..\n##..##..##..##.##\n.#....##....###..\n###...##...###.##\n#.#........#.#.##\n.#.##....##.#.###\n.#..........#....\n.#..........#.###\n##.##.##.##.#####\n##..........#####\n.#..........#.###\n.#####..#####....\n#..##....##..##..\n\n#.##.#.####\n.###.######\n#..#....##.\n#...#######\n##.##..#..#\n...#.######\n#.##.......\n.#.........\n##.####.##.\n#..####.##.\n.#.........\n#.##.......\n...#.######\n##.##..#..#\n#...#######\n#..#....##.\n.###.######\n\n.#...###...\n.....##.###\n..#..##.#..\n####.......\n..##..#.##.\n######.###.\n########..#\n########..#\n######.###.\n..##..#.##.\n####.......\n\n##....###..\n###..####..\n..#..#..##.\n...##...#.#\n.#.##.#.##.\n##.##.####.\n########.##\n..#..#..##.\n########.#.\n##.##.##...\n...##...###\n#########..\n...##....##\n\n#.....###....\n#.##.####.##.\n#..#..##..#..\n##...#..#...#\n.....#..#....\n####..##..###\n..##......##.\n##..######..#\n##.##....##.#\n##.##....##.#\n##..######..#\n\n.####.##.#.#..##.\n.....######..#..#\n..#..######..#..#\n.####.##.#.#..##.\n######..##...####\n#..##.#..#.######\n..#....#.##......\n.##.#..###...####\n.....#..#..##....\n##.#..##.###..##.\n#..##.#.##.#.#..#\n..##.#.##...##..#\n####.......#.....\n.###.####...##..#\n#..#..#.#####....\n###.#.#..###.....\n####...######....\n\n#####.###...#\n##..#.#.###..\n#..#..##..#.#\n##...##.#..#.\n#####....##.#\n.....##...###\n#####.#.#.###\n#####.#.#.###\n.....##...###\n\n..#####\n.#.....\n.######\n#..####\n.######\n..#....\n###....\n###....\n##.####\n..#.##.\n.#.####\n.######\n.#.####\n#.#####\n##.....\n\n####....#...#.###\n.#..#..####.##..#\n.##.##.##..#####.\n......##.##.#####\n###.#.##.#####.##\n.####....#...####\n.##.#....#...####\n###.#.##.#####.##\n......##.##.#####\n.##.##.##..#####.\n.#..#..####.##..#\n####....#...#.###\n####....#...#.###\n\n###...#..#...##\n...#......#.#..\n....#......#...\n##..#.####.#..#\n##..#.#..#.#..#\n##.#.######.#.#\n....#.####.#...\n..##.#.##.#.##.\n##...######...#\n###.#..##..#.##\n..#..######..#.\n\n.##..##..##..####\n####.##.####.....\n.###.##.###..####\n..#.#..#.#...####\n.............#..#\n...######...#.##.\n..#.#..#.#..####.\n\n##.##.#.#\n###.#.#.#\n###.#.#.#\n##.####.#\n...#####.\n...######\n...#..###\n..######.\n##...##.#\n##...#..#\n#####.#..\n\n#.###..\n####.##\n.#.##..\n....###\n.##....\n.##....\n.#..###\n\n......#....#.....\n#..#.########.#..\n.##.##......##.##\n....#.######.#.#.\n.#..##########..#\n#.#..###..###..#.\n####..######..###\n#.##..#.##.#..##.\n#..#..######..#..\n.#.#..##..##..#.#\n#.#...#.##.#...#.\n.#.##.#.##.#.##.#\n.#.##.#.##.#.##.#\n\n###..##\n#....##\n###..#.\n##.....\n..#..##\n#....##\n#...###\n###.###\n..##.##\n...##..\n...##..\n..##...\n##.#...\n..#....\n.##.###\n###....\n###....\n\n####.###..#\n.......###.\n......####.\n####.###..#\n###..#.####\n###.#....##\n..#.#.....#\n###.##.#.##\n##.###.###.\n####.##.#..\n##..#.#.#..\n\n#..##.....##.\n.......#..#.#\n.##..#...#.##\n.##..#...#.##\n.......#..#.#\n#..##.....##.\n.##..#.######\n######.##....\n####...##....\n....#.##.#.##\n#.....####...\n.##..###.....\n#####..#....#\n\n#..####..#...\n####..#####..\n###....###.#.\n..#....#..#..\n.#.#..#.#.###\n.###..###....\n###########..\n#...##...#.##\n...........##\n..#....#...##\n#.#....#.####\n\n.##...#.#\n.##..#...\n.##.###..\n.##..#.#.\n.##....##\n#####.##.\n.##...###\n#..#..#.#\n#..#..#.#\n.##...###\n########.\n.##....##\n.##..#.#.\n.##.###..\n.##..#...\n\n.##.#....###..#\n.##.#....###..#\n..#######......\n.######.#.##.##\n..#.#..#...###.\n##....#.#.###..\n##....#.#.###..\n..#.#..#...###.\n.######.#.##.#.\n..#######......\n.##.#....###..#\n\n.##..####..\n.##..####..\n###...##...\n...###..###\n..#.#.##.#.\n...######.#\n...#..##..#\n...#.#..#.#\n#.#.##..##.\n\n##.#.........\n#.####..##..#\n##.#.########\n##.##........\n##.##########\n#.#..........\n.#.#.........\n#.###########\n.###.#......#\n###..........\n#.#.#.##..##.\n.#....##..##.\n#.#...##..##.\n.##.##..##..#\n.#.#.#..##..#\n\n...####\n...####\n.#..#..\n######.\n##.#..#\n##.#.##\n######.\n.#..#..\n...####\n\n.....#.\n###.##.\n##...#.\n####.##\n####.##\n##...#.\n###.##.\n.....#.\n#.##...\n###..#.\n###.###\n....##.\n##.#.##\n\n##.#....#\n##.#.##.#\n...#....#\n..#.####.\n....####.\n##...##..\n....####.\n####.##..\n..#......\n##...##..\n###.####.\n#####..##\n###..##..\n\n..##..###\n..##.##..\n..##.##.#\n..##..###\n##.....##\n.....##..\n..##...#.\n##.#...#.\n##.###..#\n\n.####...##...\n..#....#..#..\n#####.##..##.\n#..#.##.##.##\n...##.#.##.#.\n####...####..\n#.......##...\n#..#....##...\n####...####..\n\n#.##..#\n...####\n...####\n#.##..#\n...##..\n###.#..\n###..#.\n.....##\n##.#...\n#.#..##\n.##...#\n.##...#\n#.##.##\n\n.##...##.##.##...\n.#.####..##..####\n.#.####..##..####\n.##...##.##.##...\n####.##.####.##.#\n##.#####....#####\n#.###..#....#..##\n...##..........##\n.#.###.######.###\n#.##.####..####.#\n..##.....##.....#\n.#..#...#..#...#.\n#.##...##..##...#\n#.#.#.##.##.##.#.\n.#..####....####.\n#...####.##.###..\n...#..#.####.#..#\n\n....#.##..#.#.##.\n#..##..#..#.#...#\n.##.##.#.#..#.##.\n.....#....#.#.##.\n####.###....#....\n#..#.#.#.#..#....\n#..###.##....####\n####..#....#.#..#\n####.#...###.#..#\n#####..#.###.....\n####.#####.#.#..#\n#####.#.###...##.\n####.##..#...####\n\n.......##......\n....########...\n#####.####.####\n##..#.####.#..#\n##.##......##.#\n....###..###...\n...#..#..#..##.\n\n..........###..\n#.####.##..#...\n#.#..#.##.#...#\n.######.###..##\n...##...##.####\n########..##...\n............#..\n\n....#.###.#..\n#..#...#...#.\n....#.##.####\n....#.##.####\n#..#...#...#.\n....#.###.#..\n......##.####\n.###.#####.##\n####.#####.##\n....#.##....#\n....##..#..#.\n.##.###....#.\n.##....####..\n#####...#.#..\n######.#..###\n\n.##.###\n...#...\n###.###\n.#.....\n#.#.#..\n####...\n..##...\n##.#...\n#......\n.#.##..\n#.#.###\n..#####\n..#####\n..#.###\n.#.##..\n\n####.#.####\n####.#..##.\n#...#.##..#\n#...#.##..#\n####.#..##.\n####.#.####\n#.#...#....\n#.....##..#\n#.#.##..##.\n.###.#..##.\n##...#.....\n.###..#....\n.####.#.##.\n....#...##.\n.####....#.\n\n....#####\n....#....\n####.#..#\n.....####\n#..######\n#..#.....\n#####....\n###.#####\n#####.##.\n#..##....\n.##.#....\n####.####\n#..#.####\n\n######..##.#.#.##\n#.........####...\n###.##.....#.##..\n##.#.###..###..##\n###..#...#....###\n#.#...#.#######..\n.#..#.###.#.##...\n.##...####.#..###\n.##....#....#.#..\n.#.##.#..#..#####\n##....###......##\n...##.######..#..\n....#.#..#.######\n##...###..##..###\n##.#.###..##..###\n\n.....###..###.#..\n#####.#...#......\n#####.##.#..#....\n.##.##.#.###.#.##\n......#..###.##..\n....#...#.####...\n.....####.#.###..\n......#.##.##.#..\n...##.##....#.#..\n#..##.##.###..###\n#..#..###.###..##\n#..#...#....###..\n....#....##.#..##\n\n....#....\n##.######\n##.#.....\n##.#.####\n##..#...#\n..#.#.##.\n......##.\n###..####\n..##.#..#\n\n..##..#\n##.....\n...####\n...####\n##.....\n..##..#\n#.#.#..\n#.##...\n#..##.#\n####...\n####...\n#..##.#\n#.##...\n..#.#..\n..##..#\n\n...##.#######\n...##.#.#####\n#....#..#..##\n#..########..\n#.##...#...##\n.#....#...#..\n.#....#...#..\n#.##...#...##\n#..########..\n#....#..#..##\n...##.#.#####\n...##.#######\n.####.....###\n######.#.#..#\n..#..#.#.####\n...#..#..####\n..####..###.#\n\n########.\n.......##\n.####.#..\n..##...##\n#....#.#.\n..##....#\n######...\n.#..#..##\n##..###..\n......##.\n..##..##.\n#.#..##..\n.#..#..##\n#....##.#\n#....##.#\n\n######.####\n#.##.######\n.#..#.##..#\n...#..##..#\n######.#..#\n.####...##.\n.......####\n######.#..#\n#....##....\n.####.#....\n......#####\n######.####\n#....##.##.\n\n.####.###.#\n.#..#......\n##..#######\n#.##.#..###\n#######..##\n######.###.\n##..##...#.\n##..##.#.#.\n######.###.\n\n.##...##..#.#\n#..#.#..#....\n.##.##.##..#.\n.##..#.#.###.\n.....#.#.#...\n.##.#.###...#\n####..###...#\n####..###...#\n.##.#.###...#\n.....#.#.#...\n.##..#.#####.\n\n#.#.#...###\n#.....#.#..\n###.##.##..\n######.####\n####.#.#..#\n###..##..#.\n.###..#.#.#\n.###..#.#.#\n###.###..#.\n####.#.#..#\n######.####\n###.##.##..\n#.....#.#..\n#.#.#...###\n####...####\n####...####\n#.#.#...###\n\n###...#...#.##.\n.#######.#.####\n.#######.#.####\n###...#...#.##.\n#.#####...#..#.\n##..#..##..#..#\n#..##.##..##..#\n\n#..#..#..######..\n#.#.##.#.#.##.#.#\n..##..##...##...#\n....##...........\n.########.#..#.##\n#...##...######..\n.#......#.#..#.#.\n#.##..##.######.#\n....##.....##....\n##......##....##.\n...####...#..#...\n#.#....#.#.##.#.#\n..#.##.#........#\n#####.####....###\n.###..###.#..#.##\n##......##....##.\n..#.##.#..####..#\n\n##.########\n.#..#....#.\n####.#..#.#\n#.##.#..#.#\n.#..#....#.\n##.########\n#.#..#..#..\n#..#..##..#\n##...####..\n.##########\n.#.########\n..###.##.##\n.#....##...\n##...####..\n##..#....#.\n##..######.\n..#.##..##.\n\n.#..#.#.#.###.##.\n.#..#.#.#.##..##.\n......####....#..\n.#..#...##..####.\n######.###...####\n.#..#..#....#.#.#\n......##...#.....\n#######.#.#######\n.#..#..##..##.##.\n\n.###.#.##......\n.......###.##.#\n.##..#..#.#..#.\n#..##.####.##.#\n####.#..###..##\n#..##.....####.\n#..#...##.#..#.\n....#.....#..#.\n####..###......\n\n#.#..##.####.\n#.#..##.####.\n.##..#.#.....\n#.###.#..#...\n....#.####..#\n...#.##..###.\n.###..#.#....\n..#....#.....\n.#.##..#..##.\n.#.##..#..##.\n..#....#.....\n.###..#.#....\n...#.##..###.\n....#.####..#\n#.###.#..#...\n.##..#.#.....\n..#..##.####.\n\n...######..\n####.#..#.#\n.#...#..#..\n#..###.#...\n#..###.#...\n.#...#..#..\n.###.#..#.#\n...######..\n..##..#..#.\n..##.##.##.\n##.#####..#\n....#.###.#\n#########..\n#.#...##...\n#.#...##...\n#########..\n....#.###.#\n\n##....####..###..\n########..#.##...\n########..#.##...\n##....####..###..\n........####....#\n.#.##.#.##.#..#.#\n........##.######\n.##...#....#.###.\n.######....#.#..#\n.#....#.#..###.#.\n.##..##...#...##.\n\n###.##.....\n#..#.###.##\n#..#..##...\n#.#..#.##..\n.##.###.##.\n###....####\n.##..#.#...\n.##..#.#...\n###....####\n.##.###.##.\n#.#..#.##..\n#..#..##...\n#..#.###.##\n###.##.....\n###.##....#\n\n#..#.....#.####.#\n####.#.#..#....#.\n#####..#.........\n#.#####.##..##..#\n#..#.#.#...####..\n#..#.##....####..\n#..#####.###..###\n.##.#....#..##..#\n#..##.#.##.#..#.#\n\n##..#..#.##.##.##\n##..#..#.##..#.##\n.#####..##.##..##\n..#.###.###..#..#\n..#.###.###..#..#\n.#####..##.##..##\n##..#..#.##..#.##\n##..#..#.##.##.##\n#...###..#.##...#\n#........#..#.##.\n#...#.#...#.##...\n\n#....##.#..\n#.##.#..###\n.####.##..#\n.####.##..#\n#.##.#...##\n#....##.#..\n##..##.#..#\n\n.#.#..#.#.#.#..##\n.##....##..#.####\n####..####..#.#..\n.##.##.##.#...#.#\n..######..##.....\n..######..##..#..\n.##.##.##.#...#.#\n\n.####.#\n.####..\n.####.#\n#....#.\n#.##.##\n##..###\n.####..\n\n#..#.#..###...##.\n#..#.#..###...##.\n#.#.....##.#.##.#\n#..#####...#.#.##\n##....###......##\n##..###.#.###..##\n.#....###...#..##\n#.###.#...#.....#\n##.....#...##.###\n......#..########\n##.#############.\n.#.#.##.....####.\n###.##.###.###..#\n####.###..#.#.#..\n#.##.#......#.##.\n#####.....#..#..#\n#####..#..#..#..#\n\n.##.####.##....##\n####.##.######...\n#.#..##..#.#...##\n##.#....#..#.#...\n...#.##.#....#...\n#..........#.....\n#.##....##.#..###\n#..#.##.#..##.###\n............#.###\n...#.##.#...#..##\n#.##.##.##.#.#...\n...#.##.#........\n...######....#...\n#.#.####.#.##.#..\n##.#....#.####.##\n...#.##.#....####\n.#.#....#.#...###\n\n...##.##..####.\n..##.#.#.#.####\n##.#.#.###.##..\n......#.#####..\n..##..#.####.##\n..##...#.#.#...\n..#.#.#...#....\n#####.##.##.#..\n##.###.##......\n..#..##..#.##..\n....#....##.#..\n...#.#.#.#.####\n##.#.##.#.##.##\n###..#....###..\n..##.#..#.#..##\n..##..#.##..###\n..#..#.##.###..\n\n.....##..#.#.##.#\n#..####.#.##..##.\n..##..##.#......#\n.##.###.###....##\n#..#.#..#........\n..##.##..###..###\n.##....#.#..##..#\n##.#.##..........\n##.#.##..........\n\n#..##....\n#....#.#.\n##.###.##\n.####.###\n#.#######\n..#.###..\n..#.###..\n\n.#.###.#...\n#.#.#.#..##\n###..#..#..\n#.#..#..#..\n#.#.#.#..##\n.#.###.#...\n#......####\n\n#.#..#..#..#.##\n.#.########.#..\n.#...##.#...#..\n.#.#......#.#..\n###...##...####\n.#..........#..\n...#......#....\n\n...#.#####.#.\n.#.#.....#..#\n#.##..#.#.###\n#.##..#.#.###\n.#.##....#..#\n...#.#####.#.\n######......#\n###.####.####\n..##.###.###.\n###......##..\n...##.#....#.\n...##.#....#.\n###......##..\n..##.###.###.\n###.####.####\n######......#\n...#.#####.#.\n\n##.#....#.#\n.#.##..##.#\n..###...##.\n#..######..\n#...#..#...\n#..#....#..\n.###.##.###\n.####..####\n#.##.##.##.\n#..######..\n...#.##.#..\n...#.##.#..\n#..######..\n#.##.##.##.\n.####..####\n.###.##.###\n#..#....#..\n\n####.#.####.####.\n#.#.#..######..##\n.##.##.....#....#\n.##.####...######\n...#..#.#.###..##\n.####.###.###..##\n#.##..#.#....##..\n#....##.#..######\n#....###..##.##.#\n#....####.##.##.#\n#....##.#..######\n#.##..#.#....##..\n.####.###.###..##\n...#..#.#.###..##\n.##.####...######\n.##.##.....#....#\n#.#.#..######..##\n\n.#.####.#.#....\n.#.####.#.#....\n.##......##...#\n.#...#....#.#..\n###..#.#..#.#.#\n####....#.##..#\n.#.#..##.#.##.#\n.##....###..#.#\n..##.##.##...#.\n.#.#.....#....#\n.#.#.....#....#\n..##.##.##...#.\n.##....###..#.#\n.#.#..##.#.##.#\n####....#.#...#\n\n....#..\n#.##..#\n#####..\n.##.##.\n####.##\n####.##\n#..###.\n#..##..\n#####..\n.....##\n.....##\n\n##.#....#..#...#.\n####..#..#####...\n####..#..#####...\n##.#....#..#...#.\n####.##.#.#.#...#\n#####....##.####.\n.#####..###.#..#.\n######.##...#.#..\n...###.....#.####\n###.##..##..####.\n..#.##.......####\n\n##.#..#.#.#\n##.##.#.#.#\n####.#..#.#\n..##.####..\n##.####.#..\n....##..#.#\n..##.###.#.\n#####.###..\n######....#\n##.#####.##\n..#.##.#.#.\n\n.##...#\n....###\n####.##\n####.##\n....###\n.##...#\n.....#.\n#..#...\n.##.#..\n...##.#\n....#..\n\n#######..####\n####.##..#...\n#..##..#...#.\n.#####....###\n.##.....##...\n....#.###..##\n#..#..##..##.\n........###.#\n........###.#\n\n####...##\n###..#...\n###.##...\n####...##\n#.#..#..#\n#.###....\n....##.##\n.#...####\n#.#..#..#\n###....##\n.....##..\n.....##..\n###....##\n\n#.#...#..#...\n...##.####.##\n...##.####.##\n#.....#..#...\n.##..##..##..\n...#...##...#\n#...#.####.#.\n##...#.##.#..\n#..##......##\n#.##...##...#\n##....####...\n\n#..###.##\n#..#.#.##\n..##.###.\n..##.#.##\n##...##.#\n##...##.#\n..##.#.##\n..##.###.\n#..#.#.##\n#..###.##\n.###..#.#\n\n...#.###....#\n..#.###.####.\n.#.#..#######\n.#####.#.##..\n#.#.#.#..##..\n##.###.......\n##.###.......\n\n#.##..##.##.#\n...####......\n#..####..##..\n##.####.####.\n####..#######\n##..##..####.\n##..##..####.\n#..#..#..##..\n..##..##....#\n..#....#....#\n...#..#......\n.##..#.##..##\n.#..##..#..#.\n#.#.##.#.##.#\n.########..##\n\n##....##.####\n.#...##.###..\n.#.#.....#.#.\n.##..#.#.#.##\n.....#.##.#.#\n.....#.##.#.#\n.##..#.#.#.##\n.#.##....#.#.\n.#...##.###..\n##....##.####\n.############\n..####.###.##\n..####.###.##\n.############\n##....##.####`;

const patternsRowIndexed = input.trim().split('\n\n')
 .map(pattern => pattern.split('\n').map(row => row.split('')));

const patternsColIndexed = patternsRowIndexed
  .map(pattern => pattern[0].map((_, i) => pattern.map(row => row[i])));

// Part 1
function isArrayEqual(arr1, arr2) {
  return arr1.every((cell, ind) => cell == arr2[ind]);
}

function getAdjacentIdentical(pattern) {
  const identicals = [];
  for (let i = 0; i < pattern.length - 1; i++) {
    if (isArrayEqual(pattern[i], pattern[i + 1])) identicals.push(i);
  }
  return identicals;
}

function isAReflection(ind, pattern) {
  for (let i = 1; i <= ind; i++) {
    if (ind + i + 1 >= pattern.length) return true;
    if (!isArrayEqual(pattern[ind - i], pattern[ind + i + 1])) return false;
  }
  return true;
}

function getRelfexionsIndice(pattern) {
  for (const row of getAdjacentIdentical(pattern)) {
    if (isAReflection(row, pattern)) return row;
  }
  return false;
}

function getRelfexionsIndices(patterns) {
  const relfexionsIndiceMap = new Map();
  for (const pattern of patterns) {
    const ind = getRelfexionsIndice(pattern);
    if (ind !== false) relfexionsIndiceMap.set(pattern, ind);
  }
  return relfexionsIndiceMap;
}

const rowsReflexions = getRelfexionsIndices(patternsRowIndexed);
const colsReflexions = getRelfexionsIndices(patternsColIndexed);
const sumOfAboveRows = [...rowsReflexions.values()].reduce((acc, ind) => acc + ind + 1, 0);
const sumOfLeftCols = [...colsReflexions.values()].reduce((acc, ind) => acc + ind + 1, 0);
console.log(sumOfLeftCols + sumOfAboveRows * 100);


// part 2
function getTheOnlyDiff(arr1, arr2) {
  let diffCount = 0;
  let diffInd;
  for (let i = 0; i < arr1.length; i++) {
    if (arr1[i] != arr2[i]) {
      diffCount++;
      diffInd = i;
      if (diffCount > 1) return false;
    }
  }
  return diffCount == 0 ? false : diffInd;
}

function getAllWithOnlyOneDiff(pattern) {
  const hasOnlyOneDiff = [];
  for (let row = 0; row < pattern.length; row++) {
    for (let secondRow = 0; secondRow < pattern.length; secondRow++) {
      const col = getTheOnlyDiff(pattern[row], pattern[secondRow]);
      if (col !== false) hasOnlyOneDiff.push({row, col});
    }
  }
  return hasOnlyOneDiff;
}

function getRelfexionIndiceOndDiff(pattern, actualRelexion) {
  for (const ind of getAdjacentIdentical(pattern)) {
    if (ind != actualRelexion && isAReflection(ind, pattern)) return ind;
  }
  return false;
}

function getRelfexionsIndicesOneDiff(patterns, actualsRelexions) {
  const relxionIndices = [];
  for (const pattern of patterns) {
    const actualRelexion = actualsRelexions.get(pattern);
    for (const {row, col} of getAllWithOnlyOneDiff(pattern)) {
      pattern[row][col] = pattern[row][col] == '#' ? '.' : '#';
      const newReflexion = getRelfexionIndiceOndDiff(pattern, actualRelexion);
      pattern[row][col] = pattern[row][col] == '#' ? '.' : '#';
      if (newReflexion !== false) {
        relxionIndices.push(newReflexion);
        break;
      }
    }
  }
  return relxionIndices;
}

const sumOfAboveRowsP2 = getRelfexionsIndicesOneDiff(patternsRowIndexed, rowsReflexions).reduce((acc, ind) => acc + ind + 1, 0);
const sumOfLeftColsP2 = getRelfexionsIndicesOneDiff(patternsColIndexed, colsReflexions).reduce((acc, ind) => acc + ind + 1, 0);
console.log(sumOfLeftColsP2 + sumOfAboveRowsP2 * 100);