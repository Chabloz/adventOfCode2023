const input = `LRLLLRRLRRLRRLRRLLRRLRRLLRRRLLRRLRRLRRLRRLRLRLLLLLRRLRRLLRLRRRLLRRLRLLLLLLLRRLRLRRRLRRLRRRLRRLLLRRLLRRRLLRRRLRRLRLRRRLRRRLRLRLLRRRLRRRLRRLLRRRLRLRRLLRLLRRLLRRLRRRLRRLRLRRLLRRRLRRRLRRRLRLRLRLRRRLLRRRLRLRRLLRRLRRLRRLRLLRRLLRRRLRRRLRRLRRLRLLRRLRLRRLRRRLRRRLRRLRLRRRLRRRLRLLLRRLRLLRRRR\n\nRLP = (BMK, PCM)\nJTJ = (TVN, CJQ)\nPFR = (MMX, BQC)\nJGM = (NDJ, PCV)\nLVD = (TCK, PVR)\nSVS = (CDL, RNX)\nQDF = (XFG, NDX)\nTBH = (THM, DBC)\nFQK = (TFT, CNF)\nTHV = (NQD, VNT)\nVRL = (HCQ, DPS)\nLDM = (CCH, PJB)\nGXR = (BRH, XLM)\nCKF = (THV, BNQ)\nKMH = (TLN, PKX)\nSLP = (XSV, VCR)\nSXF = (MJC, TJX)\nKMJ = (LBC, FKT)\nVDX = (MJQ, SGJ)\nSHM = (LJT, PBV)\nPGX = (KFM, SLD)\nVHN = (BBB, SJV)\nBFL = (VJG, JJF)\nHKX = (HNN, MQK)\nSNB = (PFJ, CTB)\nGCD = (BKX, DHR)\nDQN = (CTP, XDN)\nDJP = (GGK, NSF)\nKPG = (QCX, PQR)\nPGR = (QXN, PGT)\nRVG = (QDF, MVK)\nBMV = (FFH, FFH)\nVCX = (LDH, TQD)\nKLC = (DFP, FQD)\nJMQ = (JKT, BVH)\nKLM = (QJQ, NMB)\nTTQ = (GMV, QFC)\nXFG = (RCP, DTL)\nDDC = (FKG, JGM)\nFCD = (SPS, JSS)\nLBC = (VDX, NFH)\nRXN = (KTP, JMB)\nMVH = (NJC, LVJ)\nPJB = (RXN, JSB)\nPBS = (QGF, LSB)\nRCP = (PKL, HSJ)\nTBF = (RJP, JHJ)\nSFB = (FQH, TMH)\nXLC = (BXM, MSF)\nTCS = (TGT, GPT)\nCPQ = (JXT, FCH)\nGDM = (XBM, DDS)\nQQQ = (FLS, VCX)\nMDT = (TFS, TLV)\nPFK = (NPJ, SSR)\nKSN = (JXV, DRL)\nVBS = (NJC, LVJ)\nTCP = (TBK, XXS)\nQTT = (FLS, VCX)\nFSH = (FBM, XXN)\nMND = (KJH, MGC)\nDTN = (JNL, CGM)\nQXV = (NQJ, FSR)\nTRQ = (SNB, QRR)\nRCG = (NMR, BRG)\nTGB = (KFM, SLD)\nQSK = (NNT, TBH)\nDDD = (HPQ, XGH)\nKHK = (XMS, DXH)\nVVC = (CDB, LNP)\nKNT = (MTB, QXS)\nFBH = (HXT, FBG)\nLJB = (TBF, FXQ)\nHHH = (RPH, FSB)\nKMR = (PFT, VVC)\nCFC = (TVV, TVV)\nLKC = (LHN, QRL)\nPFT = (CDB, LNP)\nJXV = (NXS, KVX)\nXDN = (BRK, GGS)\nNQJ = (KMH, QSS)\nFQD = (PVS, JBV)\nKJX = (DJV, XPP)\nVJP = (HKX, VDR)\nBSQ = (MGS, CFK)\nVJG = (PSQ, KSD)\nNNZ = (GPT, TGT)\nCSR = (MFN, NQF)\nKFM = (GFN, GMH)\nPHR = (TJC, XTJ)\nKCL = (JJG, VJL)\nVCR = (BML, KCS)\nPVM = (BMH, QDN)\nHPQ = (LFD, FQM)\nMLR = (JKV, NTB)\nXGV = (RQL, JKX)\nFHB = (NPR, MNG)\nDBC = (LDK, TVP)\nFSN = (XQR, DBZ)\nJJF = (PSQ, KSD)\nCLK = (BMH, QDN)\nQMH = (BLQ, VKX)\nSBH = (SRN, SPX)\nMJP = (JXV, DRL)\nCTB = (XSF, XKC)\nBJK = (RKS, FQB)\nCCX = (CND, CND)\nDTL = (HSJ, PKL)\nNNT = (THM, DBC)\nGBR = (XGG, LNN)\nAAA = (XRF, DNR)\nFLJ = (GNM, MTK)\nBXQ = (LNX, GFM)\nGMH = (JXC, CSR)\nDXL = (SVN, FGV)\nXBD = (GHF, HJQ)\nPTQ = (SGQ, GVD)\nSCJ = (SJV, BBB)\nLHN = (LHH, FLK)\nHBL = (JVT, MHM)\nQLM = (TVJ, SVB)\nBRH = (HNK, CTR)\nMQJ = (GQR, DDC)\nMTM = (KLV, FGJ)\nMJQ = (LPR, JFH)\nGQJ = (GKT, JKP)\nFDC = (KPG, LDQ)\nDRN = (SBH, NNV)\nJRT = (DJP, JFJ)\nLCP = (HPL, KLJ)\nSDL = (MST, PDL)\nNGM = (DRH, RTK)\nTVV = (JSL, JSL)\nQRR = (CTB, PFJ)\nGGS = (FHF, XSJ)\nMKD = (NGR, CDR)\nGBM = (MNR, SVS)\nSHK = (NMK, KNH)\nBKB = (GHB, RVC)\nGHH = (CFC, HQT)\nCRN = (LBC, FKT)\nBCF = (CBQ, NGM)\nMQK = (DXL, JQV)\nXQK = (TTG, XTV)\nPMZ = (FBH, VMT)\nLGV = (QMH, QPM)\nTMH = (MTM, MVR)\nTRM = (DJJ, FJS)\nXFS = (XDH, VFP)\nQPM = (VKX, BLQ)\nCJN = (RXP, KLC)\nRBC = (CND, DKZ)\nRSP = (TTQ, PQQ)\nLVJ = (XXK, XGT)\nTTN = (BVH, JKT)\nMBS = (KLM, XHN)\nPJK = (CCS, TRS)\nLDX = (XGM, PBP)\nXGB = (NBS, LGV)\nQXF = (MLR, MKB)\nFFD = (MQF, MQF)\nNPR = (BMQ, TPX)\nJPN = (TBK, XXS)\nFQJ = (MXL, BXP)\nQXP = (JNL, CGM)\nXBQ = (DDS, XBM)\nNNG = (VJL, JJG)\nBLQ = (CBN, FDT)\nFQB = (XNP, SNR)\nDHR = (DCM, SHK)\nJVT = (KKR, BXQ)\nPCV = (FFD, PDG)\nPFJ = (XKC, XSF)\nRTB = (RHT, SPG)\nBXF = (PGR, CFJ)\nDGS = (MKB, MLR)\nMTK = (NJL, PQJ)\nNMS = (XQJ, TLL)\nXFF = (KHK, DRB)\nMDR = (HCQ, DPS)\nGMD = (XTT, XKV)\nFKT = (VDX, NFH)\nVNS = (PFR, GMK)\nJTB = (BSC, XFF)\nXPM = (BSQ, MFD)\nQDT = (GQJ, GPK)\nLLV = (VCR, XSV)\nBQC = (MVH, VBS)\nJLL = (CRV, HBL)\nSNH = (LJT, PBV)\nXGG = (LVD, RCD)\nLPR = (JBJ, JBH)\nQVC = (BXM, MSF)\nNMB = (HQD, FVF)\nXST = (GBM, MKH)\nVTL = (JXT, FCH)\nLDQ = (QCX, PQR)\nQKK = (GFP, CVB)\nKLV = (JCR, CJV)\nGLC = (MNG, NPR)\nGHJ = (JTB, KVQ)\nXRF = (FTK, JXN)\nJGB = (HQS, JSG)\nVNT = (NCK, TXF)\nPGT = (VVV, JDP)\nGFB = (PSM, VLK)\nTVP = (RDX, PPL)\nVKX = (CBN, FDT)\nNMR = (HLQ, NCV)\nMGQ = (TPM, MND)\nTFT = (DKH, TSX)\nCBV = (CCX, CCX)\nTJS = (RJK, RMC)\nTRX = (XBB, MDP)\nMTB = (QMV, RMR)\nXSL = (CFC, HQT)\nFRK = (SVF, LDX)\nQGM = (LDM, GMS)\nXGS = (NGR, CDR)\nCTP = (GGS, BRK)\nJXT = (JCN, KGR)\nGFM = (FJQ, TMX)\nNST = (MBS, MTX)\nNDV = (JJT, KMR)\nRDD = (MJP, KSN)\nRDX = (JTJ, SKB)\nHDF = (TVK, LCP)\nDJV = (TRF, TFJ)\nSGJ = (JFH, LPR)\nBTX = (PHB, PBS)\nKMK = (MQB, VLQ)\nHXM = (VLK, PSM)\nDPS = (QPG, HDC)\nRJP = (PGL, SXF)\nDKZ = (KCL, NNG)\nGHR = (DFN, XTH)\nXQJ = (JGB, BLH)\nBRG = (NCV, HLQ)\nHJQ = (QQQ, QTT)\nJBJ = (JRT, HDD)\nXSV = (KCS, BML)\nCDL = (QDT, NGV)\nLQS = (PCL, CKF)\nTGH = (SSR, NPJ)\nDBK = (MVC, GFJ)\nVRX = (FXB, PHR)\nRBH = (FFH, DXV)\nDRQ = (GDJ, QBV)\nGNM = (NJL, PQJ)\nNCF = (QRL, LHN)\nJQP = (KMR, JJT)\nSBN = (TXS, QXB)\nCFJ = (PGT, QXN)\nKVQ = (XFF, BSC)\nNDX = (RCP, DTL)\nSRF = (KJX, QJG)\nBFD = (LCP, TVK)\nPBN = (XKL, TJS)\nGRB = (QBV, GDJ)\nTGT = (RGF, LQT)\nTFJ = (LPT, KMK)\nSRT = (FQQ, GBR)\nTHM = (LDK, TVP)\nKVB = (RXP, KLC)\nTVJ = (QVS, SQP)\nXHN = (NMB, QJQ)\nQGF = (JVB, GCD)\nRKS = (XNP, SNR)\nMFN = (NKF, RCG)\nBVH = (QKK, TJL)\nCNF = (DKH, TSX)\nMSF = (QXP, DTN)\nKCS = (LMM, GMD)\nXGH = (LFD, FQM)\nKJH = (KLD, FNH)\nPKM = (BRH, XLM)\nVVT = (CFJ, PGR)\nXTC = (PHB, PBS)\nLQT = (BTJ, DPM)\nJKX = (TBP, QGM)\nZZZ = (DNR, XRF)\nQXS = (RMR, QMV)\nPBP = (KVB, CJN)\nTTG = (FDM, FDM)\nBML = (LMM, GMD)\nRNX = (NGV, QDT)\nTPX = (NDB, GHR)\nMFS = (SDL, LRQ)\nLGG = (LXG, JLL)\nMJC = (GVX, JJK)\nRRF = (GSK, NMS)\nFBM = (HBB, FQJ)\nPQQ = (QFC, GMV)\nFCH = (KGR, JCN)\nPDG = (MQF, FSN)\nHLQ = (NGF, FKK)\nQQB = (MTB, QXS)\nHNN = (JQV, DXL)\nTLN = (CNJ, PSX)\nNGV = (GPK, GQJ)\nLDK = (RDX, PPL)\nNJC = (XXK, XGT)\nXQA = (TGT, GPT)\nJCH = (XBB, MDP)\nKMB = (QJG, KJX)\nTCK = (VVH, SML)\nFKS = (PVM, CLK)\nGMS = (CCH, PJB)\nLHH = (GRB, DRQ)\nJML = (RQL, JKX)\nDTP = (TGH, PFK)\nBKX = (SHK, DCM)\nHPL = (QLM, DPV)\nJJG = (VKR, DQN)\nPDL = (QNS, BJC)\nSLD = (GFN, GMH)\nJQV = (SVN, FGV)\nFKK = (LLV, SLP)\nCTC = (HKX, VDR)\nTSX = (FRM, FRK)\nFNH = (BTX, XTC)\nJMB = (BCF, SKS)\nKGR = (QLB, HTP)\nTXS = (VRL, MDR)\nKNH = (DGS, QXF)\nDDS = (VHN, SCJ)\nMML = (TPM, MND)\nXKB = (SHM, SNH)\nRMC = (FRX, JRJ)\nXVP = (JSL, LSH)\nHXT = (GLC, FHB)\nFQM = (MDT, DBH)\nPSX = (LRL, GHJ)\nVSC = (FXQ, TBF)\nJFH = (JBJ, JBH)\nSML = (GSN, TVS)\nBMK = (XNT, KCD)\nVFP = (BXF, VVT)\nGHB = (LHM, HDQ)\nFDM = (SGQ, SGQ)\nFQH = (MTM, MVR)\nJJC = (GXR, PKM)\nHFM = (PKM, GXR)\nLNX = (FJQ, FJQ)\nXTT = (VRX, PML)\nTQD = (NSN, DDD)\nFGV = (XFS, FLT)\nFHF = (QXV, NVN)\nHDQ = (TTB, RLP)\nCQN = (STG, LQS)\nVNJ = (SNH, SHM)\nDPB = (JTP, PJK)\nJCQ = (CNF, TFT)\nLPF = (XMB, FBB)\nSQP = (JML, XGV)\nQSS = (TLN, PKX)\nCDB = (SDB, QJS)\nGTF = (TRQ, QNQ)\nKSD = (BMV, RBH)\nJFD = (CCX, RBC)\nGSN = (DRN, KKD)\nRXP = (DFP, FQD)\nRTK = (RDD, DTF)\nGPT = (LQT, RGF)\nTLV = (LGT, VGM)\nFSB = (HGC, TXM)\nKKD = (SBH, NNV)\nXNT = (LJB, VSC)\nLXG = (HBL, CRV)\nTTB = (PCM, BMK)\nQPG = (KKX, SFB)\nRQL = (QGM, TBP)\nJNL = (JJC, HFM)\nTPM = (KJH, MGC)\nKKR = (LNX, GFM)\nSVF = (PBP, XGM)\nLHM = (RLP, TTB)\nJDP = (XQL, NST)\nPCM = (KCD, XNT)\nTQF = (LDQ, KPG)\nNGR = (DTP, NFD)\nPPS = (NQN, RHG)\nDRL = (KVX, NXS)\nMVF = (CPP, FCD)\nSSR = (BJK, VCP)\nDRH = (RDD, DTF)\nNSJ = (FKS, XVL)\nCPS = (QDF, MVK)\nPML = (PHR, FXB)\nDPM = (MML, MGQ)\nMJS = (QKF, PMZ)\nJSS = (XPM, FLV)\nCRV = (JVT, MHM)\nQJS = (PKV, RTB)\nJHJ = (PGL, SXF)\nJSB = (KTP, JMB)\nKBN = (JHB, NJZ)\nBMJ = (CCK, GTF)\nNDJ = (FFD, FFD)\nLFD = (MDT, DBH)\nNQD = (NCK, TXF)\nNSN = (HPQ, XGH)\nXKV = (PML, VRX)\nSHS = (NBS, LGV)\nSRN = (KRJ, DPJ)\nQCX = (HHH, LLJ)\nMNG = (TPX, BMQ)\nTJX = (GVX, JJK)\nFVF = (PPS, LFK)\nLDH = (DDD, NSN)\nMVC = (FHQ, MQJ)\nTJL = (GFP, CVB)\nJXC = (MFN, NQF)\nLJT = (LKC, NCF)\nPVS = (XGB, SHS)\nVVV = (NST, XQL)\nCBQ = (DRH, RTK)\nSKS = (NGM, CBQ)\nLLJ = (FSB, RPH)\nCND = (NNG, KCL)\nJSG = (SFL, LCQ)\nNJZ = (VMD, PBN)\nPKL = (XGS, MKD)\nBLH = (JSG, HQS)\nJHB = (PBN, VMD)\nGQR = (FKG, JGM)\nCNJ = (GHJ, LRL)\nMVR = (KLV, FGJ)\nSPG = (XQC, FJX)\nFTK = (SBN, PDJ)\nFJB = (FQQ, GBR)\nLRL = (KVQ, JTB)\nPQJ = (XST, TMM)\nNXS = (JHF, SKG)\nTFS = (LGT, VGM)\nSNR = (RSP, XTB)\nDPJ = (VXJ, DBK)\nNJL = (XST, TMM)\nVCP = (FQB, RKS)\nNGF = (LLV, SLP)\nKLD = (XTC, BTX)\nQJF = (QQB, KNT)\nFHQ = (GQR, DDC)\nMQB = (VNJ, XKB)\nFHG = (LLC, QSK)\nVXJ = (GFJ, MVC)\nLJV = (TRM, FXH)\nTXM = (GFB, HXM)\nBMQ = (NDB, GHR)\nMXL = (RSB, FHL)\nTBK = (HHK, DQQ)\nGKT = (LGG, FHR)\nDTF = (KSN, MJP)\nVDJ = (MTK, GNM)\nPCL = (BNQ, THV)\nVLK = (XCH, LJV)\nBSC = (KHK, DRB)\nXTH = (VTL, CPQ)\nXXS = (HHK, DQQ)\nGMV = (MFS, XLJ)\nBMH = (SLL, CTM)\nRGF = (BTJ, DPM)\nFJS = (DPB, PLN)\nQDN = (SLL, CTM)\nCVB = (CBV, JFD)\nTMX = (XCR, KBN)\nXKC = (JQP, NDV)\nVGM = (QVC, XLC)\nFGT = (SJH, MVF)\nDXV = (DQL, MJS)\nMGC = (FNH, KLD)\nCCS = (JFG, NGD)\nSTG = (PCL, CKF)\nNKF = (BRG, NMR)\nHQT = (TVV, XVP)\nQJQ = (HQD, FVF)\nHQS = (SFL, LCQ)\nMGS = (XBD, QHS)\nQXB = (MDR, VRL)\nGFP = (CBV, CBV)\nJVX = (XRF, DNR)\nMST = (BJC, QNS)\nPBV = (NCF, LKC)\nRJS = (MVF, SJH)\nNBS = (QMH, QPM)\nQHS = (GHF, HJQ)\nXQL = (MBS, MTX)\nDQQ = (LTJ, BKB)\nSJV = (HDF, BFD)\nVLQ = (XKB, VNJ)\nCBN = (GHH, XSL)\nJKT = (QKK, TJL)\nMQF = (XQR, XQR)\nMVK = (NDX, XFG)\nCPP = (SPS, JSS)\nFJX = (NSJ, PJD)\nSKA = (VMT, FBH)\nNDB = (XTH, DFN)\nCCH = (RXN, JSB)\nVVH = (GSN, TVS)\nSVB = (SQP, QVS)\nJXN = (PDJ, SBN)\nPLN = (JTP, PJK)\nDNR = (FTK, JXN)\nRVC = (LHM, HDQ)\nQKF = (VMT, FBH)\nMNS = (GMK, PFR)\nQLB = (FSH, MQP)\nRHT = (XQC, FJX)\nKCD = (VSC, LJB)\nDQL = (QKF, QKF)\nTBP = (LDM, GMS)\nTRS = (NGD, JFG)\nJKP = (LGG, FHR)\nQXN = (VVV, JDP)\nLCQ = (XBQ, GDM)\nKLJ = (DPV, QLM)\nBFK = (NMS, GSK)\nDXH = (RVG, CPS)\nJTP = (TRS, CCS)\nMNR = (CDL, RNX)\nSFL = (XBQ, GDM)\nTJC = (MNS, VNS)\nSDB = (PKV, RTB)\nBBB = (BFD, HDF)\nQRG = (TTG, XTV)\nXSF = (NDV, JQP)\nHQD = (LFK, PPS)\nFHR = (JLL, LXG)\nFBG = (GLC, FHB)\nXCH = (FXH, TRM)\nSGQ = (TCS, TCS)\nDBZ = (GDD, CQN)\nQFC = (MFS, XLJ)\nKTP = (SKS, BCF)\nHBB = (MXL, BXP)\nTLL = (BLH, JGB)\nRMR = (CQM, FHG)\nBXM = (DTN, QXP)\nGDD = (LQS, STG)\nDFN = (VTL, CPQ)\nDBH = (TLV, TFS)\nHNK = (CTC, VJP)\nFRX = (RRF, BFK)\nXMB = (TGB, PGX)\nNTB = (DBB, LPF)\nMFD = (MGS, CFK)\nJFJ = (GGK, NSF)\nGDJ = (FQK, JCQ)\nXCR = (JHB, JHB)\nLRQ = (PDL, MST)\nDPV = (SVB, TVJ)\nHDC = (SFB, KKX)\nLMM = (XTT, XKV)\nSLL = (TRX, JCH)\nPSQ = (BMV, RBH)\nVJL = (VKR, DQN)\nSPX = (DPJ, KRJ)\nDBB = (FBB, XMB)\nSPS = (FLV, XPM)\nFRM = (LDX, SVF)\nPKX = (CNJ, PSX)\nTMM = (GBM, MKH)\nVDR = (MQK, HNN)\nMHM = (KKR, BXQ)\nTVN = (XQK, QRG)\nNSF = (VDJ, FLJ)\nFXH = (DJJ, FJS)\nFGJ = (JCR, CJV)\nSJH = (FCD, CPP)\nJJT = (VVC, PFT)\nDRB = (DXH, XMS)\nLNP = (QJS, SDB)\nFKG = (NDJ, PCV)\nCQM = (LLC, QSK)\nHTP = (FSH, MQP)\nFJQ = (XCR, XCR)\nCFK = (QHS, XBD)\nQJG = (DJV, XPP)\nKKX = (FQH, TMH)\nLSJ = (TCP, JPN)\nQHD = (JPN, TCP)\nPVR = (SML, VVH)\nXSJ = (NVN, QXV)\nQMV = (FHG, CQM)\nNFD = (TGH, PFK)\nLTJ = (GHB, RVC)\nHCQ = (HDC, QPG)\nJKV = (LPF, DBB)\nBNQ = (NQD, VNT)\nGGK = (VDJ, FLJ)\nLLC = (NNT, TBH)\nSKB = (TVN, CJQ)\nKRJ = (DBK, VXJ)\nBTJ = (MML, MGQ)\nGJM = (CCK, GTF)\nJHF = (QHD, LSJ)\nGFJ = (FHQ, MQJ)\nLFK = (NQN, RHG)\nGVD = (TCS, NNZ)\nXDH = (VVT, BXF)\nNCK = (BMJ, GJM)\nQRL = (FLK, LHH)\nXKL = (RJK, RMC)\nTXF = (BMJ, GJM)\nTVS = (DRN, KKD)\nFXQ = (JHJ, RJP)\nXTB = (PQQ, TTQ)\nXBB = (SRT, FJB)\nDFP = (JBV, PVS)\nNQA = (NNG, KCL)\nDKH = (FRM, FRK)\nCCK = (TRQ, QNQ)\nXTJ = (MNS, VNS)\nMDP = (FJB, SRT)\nQBV = (JCQ, FQK)\nPKV = (RHT, SPG)\nCJV = (FDC, TQF)\nLSH = (JVX, ZZZ)\nJJK = (CRN, KMJ)\nLPT = (MQB, VLQ)\nRHG = (BFL, SJT)\nFLT = (XDH, VFP)\nKVX = (JHF, SKG)\nFXB = (XTJ, TJC)\nHSJ = (XGS, MKD)\nPDJ = (TXS, QXB)\nXNP = (XTB, RSP)\nLGT = (QVC, XLC)\nXPP = (TRF, TFJ)\nXQR = (CQN, GDD)\nNNV = (SRN, SPX)\nFLV = (MFD, BSQ)\nQVS = (XGV, JML)\nJSL = (JVX, JVX)\nCQP = (QQB, KNT)\nTVK = (KLJ, HPL)\nQNS = (JMQ, TTN)\nBXP = (FHL, RSB)\nJFG = (KMB, SRF)\nGMK = (MMX, BQC)\nMTX = (KLM, XHN)\nCTM = (JCH, TRX)\nXBM = (SCJ, VHN)\nRCD = (PVR, TCK)\nXLJ = (LRQ, SDL)\nPPL = (JTJ, SKB)\nNQF = (NKF, RCG)\nRSB = (FGT, RJS)\nNCV = (FKK, NGF)\nGHF = (QTT, QQQ)\nXVL = (PVM, CLK)\nVMD = (XKL, TJS)\nCTR = (VJP, CTC)\nCGM = (JJC, HFM)\nPJD = (XVL, FKS)\nLJA = (CQN, GDD)\nMKH = (MNR, SVS)\nJVB = (DHR, BKX)\nHDD = (DJP, JFJ)\nXGM = (CJN, KVB)\nHHK = (LTJ, BKB)\nCJQ = (XQK, QRG)\nFHL = (RJS, FGT)\nFQQ = (XGG, LNN)\nMMX = (MVH, VBS)\nFLS = (TQD, LDH)\nVMT = (HXT, FBG)\nPSM = (LJV, XCH)\nJBV = (XGB, SHS)\nFSR = (QSS, KMH)\nFDT = (GHH, XSL)\nLSB = (GCD, JVB)\nXMS = (CPS, RVG)\nFLK = (GRB, DRQ)\nPGL = (TJX, MJC)\nJCN = (HTP, QLB)\nJRJ = (RRF, BFK)\nFFH = (DQL, DQL)\nXTV = (FDM, PTQ)\nVKR = (XDN, CTP)\nXXK = (CQP, QJF)\nSKG = (QHD, LSJ)\nMQP = (XXN, FBM)\nGFN = (JXC, CSR)\nBJC = (TTN, JMQ)\nNVN = (FSR, NQJ)\nPHB = (QGF, LSB)\nNPJ = (VCP, BJK)\nLNN = (LVD, RCD)\nBRK = (FHF, XSJ)\nJBH = (HDD, JRT)\nXXN = (FQJ, HBB)\nSJT = (JJF, VJG)\nDCM = (NMK, KNH)\nGSK = (XQJ, TLL)\nXGT = (CQP, QJF)\nRJK = (FRX, JRJ)\nDJJ = (PLN, DPB)\nTRF = (LPT, KMK)\nJCR = (TQF, FDC)\nRPH = (TXM, HGC)\nMKB = (NTB, JKV)\nXQC = (PJD, NSJ)\nNGD = (SRF, KMB)\nGVX = (KMJ, CRN)\nGPK = (GKT, JKP)\nSVN = (FLT, XFS)\nFBB = (PGX, TGB)\nCDR = (DTP, NFD)\nHGC = (HXM, GFB)\nPQR = (HHH, LLJ)\nQNQ = (SNB, QRR)\nNVA = (PBN, VMD)\nNFH = (SGJ, MJQ)\nNMK = (QXF, DGS)\nXLM = (CTR, HNK)\nNQN = (SJT, BFL)`;

function inputToMap(input) {
  const lines = input.replaceAll(' ', '').split('\n');
  const directions = lines[0].split('');
  const map = new Map();
  for (let i = 2; i < lines.length; i++) {
    const lineData = lines[i].split('=');
    const node = lineData[0];
    const dest = {
      L: lineData[1].split(',')[0].replace('(', ''),
      R: lineData[1].split(',')[1].replace(')', ''),
    };
    map.set(node, dest);
  }
  return {directions, map};
}

const  {directions, map}  = inputToMap(input);

// Part 1
let curNode = 'AAA';
const destination = 'ZZZ';
let steps = 0;
while (curNode != destination) {
  const turn = directions[steps % directions.length];
  curNode = map.get(curNode)[turn];
  steps++;
}
console.log(steps);

// Part 2
function getLeastCommonMultipleOfEachNumbers(...numbers) {
  let lcm = 1;
  for (const number of numbers) {
    lcm = getLeastCommonMultiple(lcm, number);
  }
  return lcm;
}

function getLeastCommonMultiple(a, b) {
  return (a * b) / greatestCommonDivisor(a,b);
}

function greatestCommonDivisor(a, b) {
  if (b == 0) return a;
  const r = a % b;
  return greatestCommonDivisor(b, r);
}

function getStepsToAnyDestinations(startNode, destNodes, startingSteps = 0) {
  let steps = startingSteps;
  let curNode = startNode;
  while (!destinations.has(curNode) || steps == startingSteps) {
    const turn = directions[steps % directions.length];
    curNode = map.get(curNode)[turn];
    steps++;
  }
  return steps;
}

let curNodes = [...map.keys()].filter(n => n.endsWith('A'));
let destinations  = new Set([...map.keys()].filter(n => n.endsWith('Z')));

const nbStepsOfEachCycles = [];
for (const node of curNodes) {
  const steps = getStepsToAnyDestinations(node, destinations);
  nbStepsOfEachCycles.push(steps);
}
// Each path has a cycle to reach the next destination
// Finding the first is enough and then we get least common multiple
// of the numbers of steps of each path
console.log(getLeastCommonMultipleOfEachNumbers(...nbStepsOfEachCycles));